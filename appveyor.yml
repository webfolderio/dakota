version: 1.0.'{build}'
image:
 - ubuntu1804

build_script:
  - sh: git clone https://github.com/Microsoft/vcpkg.git
  - sh: CC=gcc-8 CXX=g++-8 ./vcpkg/bootstrap-vcpkg.sh
  - sh: ./vcpkg/vcpkg integrate install
  - sh: ./vcpkg/vcpkg install restinio:x64-linux
  - sh: cd native
  - sh: mkdir build
  - sh: CC=gcc-8 CXX=g++-8 cmake .. -DCMAKE_TOOLCHAIN_FILE=/home/appveyor/projects/dakota/vcpkg/scripts/buildsystems/vcpkg.cmake -DVCPKG_TARGET_TRIPLET=x64-linux
  - sh: cmake .. -DCMAKE_BUILD_TYPE=Release
  - sh: make
  - sh: strip /home/appveyor/projects/dakota/build/libdakota.so
  - sh: cp /home/appveyor/projects/dakota/native/build/libdakota.so /home/appveyor/projects/dakota/src/main/resources/META-INF
  - sh: cd /home/appveyor/projects/dakota && mvn package
